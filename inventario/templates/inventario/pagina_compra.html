<!DOCTYPE html>

<html lang="es">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Cat치logo | Pa침alera</title>

    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>

        body {

            font-family: 'Inter', sans-serif;

            background-color: #e5e7eb;
        }

        /* Aplica una altura m칤nima al contenedor del producto para evitar saltos de fila */
        /* Eliminamos la min-height fija para que el dise침o sea m치s fluido y dependa de flex-grow */
        
        .card-shadow {

            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);

        }

        .text-colombian-price {

            color: #10B981; /* Un color verde vibrante */

        }

    </style>

</head>

<body class="min-h-screen flex flex-col">



    <nav class="bg-indigo-700 p-4 shadow-xl">

        <div class="container mx-auto flex justify-between items-center">

            <h1 class="text-3xl font-extrabold text-white tracking-wider">Pa침alera</h1>

            <div>

                {% if user.is_authenticated %}

                <span class="text-white text-sm mr-3">Hola, {{ user.username }}</span>

                <a href="{% url 'logout' %}" class="bg-indigo-500 text-white px-3 py-1 rounded-full font-medium hover:bg-indigo-400 transition duration-150 text-sm">Cerrar Sesi칩n</a>

                {% else %}

                <a href="{% url 'login' %}" class="bg-indigo-500 text-white px-3 py-1 rounded-full font-medium hover:bg-indigo-400 transition duration-150 text-sm">Iniciar Sesi칩n</a>

                {% endif %}

            </div>

        </div>

    </nav>


    <!-- CORRECCI칍N: 'clase' a 'class' y 'contenedor' a 'container' (aunque el original ya lo hac칤a) -->
    <div class="container mx-auto p-6 flex-grow">

        <!-- CORRECCI칍N: 'clase' a 'class' -->
        <h2 class="text-4xl font-black text-gray-800 mb-8 border-b-4 border-indigo-500 pb-3">

            Nuestro Cat치logo <span class="text-indigo-600 font-light text-xl block sm:inline"></span>

        </h2>
        
        <!-- CORRECCI칍N: {% si %} a {% if %} -->
        {% if productos %}

        <!-- CORRECCI칍N: 'clase' a 'class' -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">


            <!-- CORRECCI칍N: {% para producto en productos %} a {% for producto in productos %} -->
            {% for producto in productos %}
            <!-- CORRECCI칍N: 'clase' a 'class' y clases traducidas -->
            <div class="bg-white rounded-xl card-shadow transition duration-300 hover:shadow-2xl overflow-hidden flex flex-col"> 


                <!-- Imagen correcta -->
                <!-- CORRECCI칍N: 'clase' a 'class' -->
                <div class="bg-indigo-100 h-48 w-full flex items-center justify-center overflow-hidden">


                    <!-- CORRECCI칍N: {% si producto.imagen %} a {% if producto.imagen %} -->
                    {% if producto.imagen %}
                        <img 
                            src="{{ producto.imagen.url }}" 
                            alt="{{ producto.nombre }}"
                            class="object-cover w-full h-full"
                        >
                    <!-- CORRECCI칍N: {% m치s %} a {% else %} -->
                

                </div>
                
                <!-- AQUI COMIENZA EL CAMBIO CLAVE: h-full y flex-col -->
                <!-- CORRECCI칍N: 'clase' a 'class' -->
                <div class="p-6 flex flex-col flex-grow">
                    
                    <!-- Contenido Superior (el que puede variar de altura) -->
                    <!-- CORRECCI칍N: 'clase' a 'class' y 'crecimiento flexible' a 'flex-grow' -->
                    <div class="flex-grow">
                        <!-- CORRECCI칍N: clases traducidas -->
                        <span class="inline-block bg-indigo-100 text-indigo-800 text-xs font-semibold px-3 py-1 rounded-full mb-3">

                            <!-- CORRECCI칍N: Usamos producto.categoria.nombre en lugar de producto.tipo -->

                            {{ producto.categoria.nombre }}

                        </span>
                        
                        <!-- CORRECCI칍N: 'clase' a 'class' -->
                        <h3 class="text-2xl font-bold text-gray-900 mb-1">{{ producto.nombre }}</h3>
                        <p class="text-base text-gray-500 mb-4">{{ producto.variaci칩n }}</p>
                    </div>
                    
                    <!-- Secci칩n de Precio y Stock (Siempre al final del contenido superior) -->
                    <!-- CORRECCI칍N: 'clase' a 'class' -->
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 border-t pt-4">

                        <!-- CORRECCI칍N: 'clase' a 'class' y atributo 'precio-datos' a 'data-price' -->
                        <span class="text-3xl font-extrabold text-colombian-price tracking-tight" data-price="{{ producto.precio|floatformat:0 }}">

                            $ {{ producto.precio|floatformat:0 }}

                        </span>
                        
                        <!-- CORRECCI칍N: 'clase' a 'class' y 'texto-derecha' eliminado, se usan clases flex para esto -->
                        <div class="mt-3 sm:mt-0 sm:text-right">
                            <!-- CORRECCI칍N: {% si producto.stock < 10 %} a {% if producto.stock < 10 %} -->
                            {% if producto.stock < 10 %}
                            <!-- CORRECCI칍N: 'clase' a 'class' y 'redondeado-lg' -->
                            <span class="text-xs font-bold text-red-600 bg-red-100 px-3 py-1 rounded-lg">

                                춰Stock Bajo! ({{ producto.stock }})

                            </span>
                            <!-- CORRECCI칍N: {% m치s %} a {% else %} -->
                            {% else %}
                            <span class="text-sm text-gray-600">En stock: {{ producto.stock }} uds</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Bot칩n (Siempre alineado al fondo gracias a flex-grow) -->
                    <div> 
                        <!-- CORRECCI칍N: 'bot칩n' a 'button', 'clase' a 'class' y clases traducidas -->
                        <button class="w-full bg-indigo-500 text-white py-3 rounded-lg font-medium hover:bg-indigo-600 transition duration-200 opacity-80 cursor-default" disabled>

                            Ver Detalles

                        </button>


                        <p class="text-xs text-gray-400 mt-2 text-center">

                            Inicie sesi칩n como administrador para registrar ventas.

                        </p>
                    </div>


                </div>
                <!-- FIN DEL CAMBIO CLAVE -->


            </div>
            {% endfor %}


        </div>
        <!-- CORRECCI칍N: {% m치s %} a {% else %} -->
        {% else %}


        <div class="bg-white p-10 rounded-xl shadow-lg text-center">

            <p class="text-xl text-gray-600 font-medium">游 Lo sentimos, no hay productos disponibles.</p>

        </div>


        {% endif %}
    </div>


    <footer class="bg-gray-300 p-4 text-center text-sm text-gray-700 mt-auto">

        춸 2025 Pa침alera Project | Versi칩n de Cat치logo P칰blico

    </footer>


    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // CORRECCI칍N: El selector ahora usa 'data-price' en lugar de 'precio-datos'
            const priceElements = document.querySelectorAll('[data-price]');

            priceElements.forEach(element => {

                const rawPrice = element.getAttribute('data-price');

                if (rawPrice) {

                    try {

                        // Usamos la configuraci칩n regional de Colombia para el formato de miles y decimales

                        const number = parseInt(rawPrice);
                        // Asegura que la conversi칩n y el formato se hacen correctamente
                        const formattedPrice = number.toLocaleString('es-CO', {
                            minimumFractionDigits: 0,
                            maximumFractionDigits: 0
                        });
                        
                        element.textContent = `$ ${formattedPrice}`;

                    } catch (e) {

                         // Manejo de error si la conversi칩n falla
                         console.error("Error al formatear el precio:", e);

                    }

                }

            });

        });

    </script>


</body>

</html>